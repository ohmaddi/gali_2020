gali_joined  <- gali_joined %>% mutate(capital_raised1 = gali_joined %>% select(starts_with("fu1inv_") & ends_with("_m1")) %>%
rowSums(na.rm = TRUE))
gali_joined  <- gali_joined %>% mutate(capital_raised2 = gali_joined %>% select(starts_with("fu2inv_") & ends_with("_m1")) %>%
rowSums(na.rm = TRUE))
gali_joined  <- gali_joined %>% mutate(capital_raised3 = gali_joined %>% select(starts_with("fu3inv_") & ends_with("_m1")) %>%
rowSums(na.rm = TRUE))
gali_joined  <- gali_joined %>% mutate(capital_raised4 = gali_joined %>% select(starts_with("fu4inv_") & ends_with("_m1")) %>%
rowSums(na.rm = TRUE))
gali_joined  <- gali_joined %>% mutate(capital_raised_tot = gali_joined %>% select(starts_with("capital_raised")) %>%
rowSums(na.rm = TRUE))
gali_joined <- gali_joined %>% mutate(revenue_tot = gali_joined %>%
select(contains("revenues")) %>%
rowSums(na.rm = TRUE))
gali_joined <- gali_joined %>% mutate(equity_sources_tot = gali_joined %>%
select(contains("equityfrom")) %>%
rowSums(na.rm = TRUE))
#Function to extract coefficients of summary table
summary_table <- function(x){ x$coefficients %>%
as.data.frame %>%
rename(
"$b$" = "Estimate"
, "SE" = "Std. Error"
, "$t$" = "t value"
) %>%
mutate(
Effect = papaja:::prettify_terms(rownames(.))
) %>%
printnum(
digits = c(2, 2, 2, 3)
, gt1 = c(TRUE, TRUE, TRUE, TRUE, FALSE, FALSE)
, zero = c(TRUE, TRUE, TRUE, TRUE, FALSE, FALSE)
) %>%
select(Effect, `$b$`, `SE`, `$t$`)}
#for glmer
summary_table_z <- function(x){ x$coefficients %>%
as.data.frame %>%
rename(
"$b$" = "Estimate"
, "SE" = "Std. Error"
, "$z$" = "z value"
) %>%
mutate(
Effect = papaja:::prettify_terms(rownames(.))
) %>%
printnum(
digits = c(2, 2, 2, 3)
, gt1 = c(TRUE, TRUE, TRUE, TRUE, FALSE, FALSE)
, zero = c(TRUE, TRUE, TRUE, TRUE, FALSE, FALSE)
) %>%
select(Effect, `$b$`, `SE`, `$z$`)}
library(lme4)
fit0hc <- glmer(participated ~  accel_ben_rank_business_skills + (accel_ben_rank_business_skills|country), data = gali_joined, family=binomial)
fit0hc <- glmer(participated ~  accel_ben_rank_business_skills + (accel_ben_rank_business_skills|country), data = gali_joined, family=binomial)
hc0 <- summary_table_z(summary(fit0hc))
hc0 <- summary_table_z(summary(fit0hc))
rownames(hc0) <- c("Intercept","Attention to Human capital(AHC)")
kable(hc0[,-1])
gali <- import("Data/GALI_External_DataRelease_2020.xlsx")
count(gali,info_venture_country_hq)
#Removing countries with less than 6 ventures.
countries_to_keep <- gali %>%
group_by(gali$info_venture_country_hq) %>%
summarize(Count=n()) %>%
mutate(Percent = round((Count/sum(Count)*100))) %>%
arrange(desc(Count))
countries_to_keep <- filter(countries_to_keep, `gali$info_venture_country_hq` != 'NA')
countries_to_keep <- filter(countries_to_keep, Count >9)
countries_to_keep$`gali$info_venture_country_hq`
gali <- gali %>%
filter(info_venture_country_hq  %in% countries_to_keep$`gali$info_venture_country_hq`)
gali <- filter(gali, found_name1_age > 14 | is.na(found_name1_age))
gali <- filter(gali, found_name2_age > 14 | is.na(found_name2_age))
gali <- filter(gali, found_name3_age > 14 | is.na(found_name3_age))
gali <- filter(gali, found_name1_age < 70 | is.na(found_name1_age))
gali <- filter(gali, found_name2_age < 70 | is.na(found_name2_age))
gali <- filter(gali, found_name3_age < 70 | is.na(found_name3_age))
#Keep only for porfit firms
gali <- filter(gali, info_legal_status == "For-profit company" )
#firms that are 5 years or younger when they entered the acceleration program (when data was collected)
if (gali$application_year == 2013) { gali <- filter(gali, info_founding_year > 2007)
}  else if (gali$application_year == 2014) {gali <- filter(gali, info_founding_year > 2008)
} else if (gali$application_year == 2015) {gali <- filter(gali, info_founding_year > 2009)
}  else if (gali$application_year == 2016) {gali <- filter(gali, info_founding_year > 2010)
} else if (gali$application_year == 2017) {gali <- filter(gali, info_founding_year > 2011)
}  else gali <- filter(gali, info_founding_year > 2012)
gali <- gali %>%
rename(country = info_venture_country_hq) %>%
rename(year = program_year)
gali$country[gali$country == "United States of America"] <-"USA"
gali$country[gali$country == "Tanzania, United Republic of"] <-"Tanzania"
countries_to_keep <- gali %>%
group_by(gali$country) %>%
summarize(Count=n()) %>%
mutate(Percent = round((Count/sum(Count)*100))) %>%
arrange(desc(Count))
countries_to_keep <- filter(countries_to_keep, `gali$country` != 'NA')
countries_to_keep <- filter(countries_to_keep, Count >9)
countries_to_keep$`gali$country`
gali <- gali %>%
filter(country  %in% countries_to_keep$`gali$country`)
gci <- import("Data/GCI_2018.xlsx")
gci <- filter(gci, `Series Global ID` == "EOSQ089" |
`Series Global ID` == "EOSQ425" |
`Series Global ID` == "EOSQ109" |
`Series Global ID` == "DOMCREDITGDP" |
`Series Global ID` == "EOSQ403")
gci <- filter(gci, Edition ==2018 )
gci <- filter(gci, Attribute == "VALUE")
gci <- select(gci, -c("Index", "Edition", "Freeze date", "Series units", "Series order", "Series code (if applicable)", "Attribute", "Series name"))
gci <- gci %>%
gather(country, score, -`Series Global ID`)
gci$country[gci$country == "United States"] <-"USA"
gci <- gci %>%
filter(country  %in% countries_to_keep$`gali$country`)
gci$score <- round(as.numeric(gci$score),2)
gci <- clean_names(gci)
gci <- gci %>%
pivot_wider(names_from = series_global_id,
values_from = score)
#Removing ventures that ranked benefits outside of given scale (i.e. 1 to 7)
gali <- filter(gali, accel_ben_rank_network <= 7 & accel_ben_rank_business_skills
<= 7 & accel_ben_rank_mentorship <= 7 & accel_ben_rank_access_investors <= 7 & accel_ben_rank_direct_funding <= 7 & accel_ben_rank_access_entreprene <= 7 & accel_ben_rank_aware_cred <= 7 )
#Removing ventures that gave the same ranking to two or more benefits
gali <- filter(gali,
accel_ben_rank_network != accel_ben_rank_business_skills &
accel_ben_rank_network != accel_ben_rank_mentorship &
accel_ben_rank_network != accel_ben_rank_access_investors &
accel_ben_rank_network != accel_ben_rank_direct_funding &
accel_ben_rank_network != accel_ben_rank_access_entreprene &
accel_ben_rank_network != accel_ben_rank_aware_cred )
gali <- filter(gali,
accel_ben_rank_business_skills != accel_ben_rank_mentorship &
accel_ben_rank_business_skills != accel_ben_rank_access_investors &
accel_ben_rank_business_skills != accel_ben_rank_direct_funding &
accel_ben_rank_business_skills != accel_ben_rank_access_entreprene &
accel_ben_rank_business_skills != accel_ben_rank_aware_cred )
gali <- filter(gali,
accel_ben_rank_mentorship != accel_ben_rank_access_investors &
accel_ben_rank_mentorship != accel_ben_rank_direct_funding &
accel_ben_rank_mentorship != accel_ben_rank_access_entreprene &
accel_ben_rank_mentorship != accel_ben_rank_aware_cred )
gali <- filter(gali,
accel_ben_rank_access_investors != accel_ben_rank_direct_funding &
accel_ben_rank_access_investors != accel_ben_rank_access_entreprene &
accel_ben_rank_access_investors != accel_ben_rank_aware_cred )
gali <- filter(gali,
accel_ben_rank_direct_funding != accel_ben_rank_access_entreprene &
accel_ben_rank_direct_funding != accel_ben_rank_aware_cred )
gali <- filter(gali,
accel_ben_rank_access_entreprene != accel_ben_rank_aware_cred )
#Reverse code fundtion
reverse <- function(x){x*-1 +8}
gali_att <- as.data.frame(lapply(gali %>%
select(starts_with("accel_ben_rank_")), reverse))
gali <- cbind(gali %>%
select(-starts_with("accel_ben_rank_")), gali_att)
a <- gali %>%
select(country, starts_with("accel_ben_rank_"))
colnames(a) <- c( "Country", "Network", "Business Skills", "Mentorship", "Investors", "Direct Funding", "Peers", "Credibility")
a <- a %>%
pivot_longer(!Country, names_to = "Attention", values_to = "Score")
a  %>%
ggplot(aes(Score)) +
geom_bar() +
facet_grid(~Attention) +
theme_bw()
gali <- gali %>% mutate(revenue_tot = gali %>%
select(contains("revenues")) %>%
rowSums(na.rm = TRUE))
gali  <- gali %>% mutate(hr_tot = gali %>%
select(contains("_employees")) %>%
rowSums(na.rm = TRUE))
gali <- gali %>% mutate(equity_sources_tot = gali %>%
select(contains("equityfrom")) %>%
rowSums(na.rm = TRUE))
gali <- gali %>% mutate(equity_sources_tot = gali %>%
select(contains("equityfrom")) %>%
rowSums(na.rm = TRUE))
gali %>%
select(country, equity_sources_tot, starts_with("accel_ben_rank_"))
colnames(b) <- c( "Country", "Total Equity Sources", "Network", "Business Skills", "Mentorship", "Investors", "Direct Funding", "Peers", "Credibility")
b <- gali %>%
select(country, equity_sources_tot, starts_with("accel_ben_rank_"))
colnames(b) <- c( "Country", "Total Equity Sources", "Network", "Business Skills", "Mentorship", "Investors", "Direct Funding", "Peers", "Credibility")
b %>%
pivot_longer(!c("Country", "Total Equity Sources"), names_to = "Attention", values_to = "Score")
filter(b, Attention == "Network")
b
b <- b %>%
pivot_longer(!c("Country", "Total Equity Sources"), names_to = "Attention", values_to = "Score")
filter(b, Attention == "Network")
filter(b, Attention == "Network")  %>%
ggplot(aes(Score, `Total Equity Sources`)) +
geom_point()  +
theme_bw()
filter(b, Attention == "Network")  %>%
ggplot(aes(Score, `Total Equity Sources`)) +
geom_point()  +
facet_grid(~Country)+
theme_bw()
wb <- import("CLASS.xls")
wb <- import("Data/CLASS.xls")
wb
a <- left_join(a, wb, by = "Country" )
a <- gali %>%
select(country, starts_with("accel_ben_rank_"))
colnames(a) <- c( "Country", "Network", "Business Skills", "Mentorship", "Investors", "Direct Funding", "Peers", "Credibility")
a <- left_join(a, wb, by = "Country" )
a <- a %>%
pivot_longer(!Country, names_to = "Attention", values_to = "Score")
a
a %>%
pivot_longer(!c("Country", "Region","Income group"), names_to = "Attention", values_to = "Score")
a <- a %>%
pivot_longer(!c("Country", "Region","Income group"), names_to = "Attention", values_to = "Score")
a  %>%
ggplot(aes(Score)) +
geom_bar() +
facet_grid(~Attention) +
theme_bw()
a
a  %>%
ggplot(aes(Score)) +
geom_bar() +
facet_grid(~Attention, ~`Income group`) +
theme_bw()
a  %>%
ggplot(aes(Score)) +
geom_bar() +
facet_grid(vars(Attention), vars(Income group)) +
a  %>%
ggplot(aes(Score)) +
geom_bar() +
facet_grid(vars(Attention), vars(`Income group`)) +
theme_bw()
a  %>%
filter(`Income group` != NA)
a  %>%
filter(`Income group` == NA)
a
a[is.na(a)]
filter(a, `Income group` == NA)
filter(a, is.na(`Income group`))
a[is.na(a)] <- "High Income"  #The two countries with NA values are USA and UK because of naming issues. They are both classified high income
a  %>%
ggplot(aes(Score)) +
geom_bar() +
facet_grid(vars(Attention), vars(`Income group`)) +
theme_bw()
capFirst <- function(s) {
paste(toupper(substring(s, 1, 1)), substring(s, 2), sep = "")
}
a$`Income group` <- capFirst(a$`Income group`)
a  %>%
ggplot(aes(Score)) +
geom_bar() +
facet_grid(vars(Attention), vars(`Income group`)) +
theme_bw()
capFirst(a$`Income group`)
str_to_upper(a$`Income group`)
str_sub(a$`Income group`, 1,1)
str_sub(a$`Income group`, 2,1)
str_sub(a$`Income group`, 3,1)
str_sub(a$`Income group`, 1,3)
str_sub(a$`Income group`, 3,3)
str_sub(a$`Income group`, 4,4)
str_sub(a$`Income group`, 5,5)
paste(toupper(substring(s, 1,1)), substring(s, 2),
sep="", collapse=" ")
paste(toupper(substring(s, 1,1)), substring(s, 2),
sep="", collapse=" ")
simpleCap <- function(x) {
s <- strsplit(x, " ")[[1]]
paste(toupper(substring(s, 1,1)), substring(s, 2),
sep="", collapse=" ")
}
simpleCap(a$`Income group`)
a$`Income group` <- simpleCap(a$`Income group`)
a  %>%
ggplot(aes(Score)) +
geom_bar() +
facet_grid(vars(Attention), vars(`Income group`)) +
theme_bw()
a$`Income group`
a <- gali %>%
select(country, starts_with("accel_ben_rank_"))
colnames(a) <- c( "Country", "Network", "Business Skills", "Mentorship", "Investors", "Direct Funding", "Peers", "Credibility")
a <- left_join(a, wb, by = "Country" )
a <- a %>%
pivot_longer(!c("Country", "Region","Income group"), names_to = "Attention", values_to = "Score")
a[is.na(a)] <- "High Income"  #The two countries with NA values are USA and UK because of naming issues. They are both classified high income
a$`Income group`
paste(toupper(substring(s, 1,1)), substring(s, 2),
sep="", collapse=" ")
simpleCap <- function(x) {
s <- strsplit(x, " ")[[1]]
paste(toupper(substring(s, 1,1)), substring(s, 2),
sep="", collapse=" ")
}
simpleCap(a$`Income group`)
gsub("(^|[[:space:]])([[:alpha:]])", "\\1\\U\\2", a$`Income group`, perl=TRUE)
a$`Income group` <- gsub("(^|[[:space:]])([[:alpha:]])", "\\1\\U\\2", a$`Income group`, perl=TRUE)
a  %>%
ggplot(aes(Score)) +
geom_bar() +
facet_grid(vars(Attention), vars(`Income group`)) +
theme_bw()
a  %>%
ggplot(aes(Score)) +
geom_bar() +
facet_grid(vars(`Income group`), vars(Attention)) +
theme_bw()
a  %>%
ggplot(aes(Score)) +
geom_bar() +
facet_grid(vars(`Income group`), vars(Attention)) +
theme_bw()
b <- gali %>%
select(country, equity_sources_tot, starts_with("accel_ben_rank_"))
colnames(b) <- c( "Country", "Total Equity Sources", "Network", "Business Skills", "Mentorship", "Investors", "Direct Funding", "Peers", "Credibility")
b <- left_join(b, wb, by = "Country" )
b <- b %>%
pivot_longer(!c("Country", "Total Equity Sources"), names_to = "Attention", values_to = "Score")
b <- b %>%
pivot_longer(!c("Country", "Total Equity Sources", "Income group", "Region"), names_to = "Attention", values_to = "Score")
b[is.na(b)] <- "High Income"  #The two countries with NA values are USA and UK because of naming issues. They are both classified high income
filter(b, Attention == "Network")  %>%
ggplot(aes(Score, `Total Equity Sources`)) +
geom_point()  +
facet_grid(~`Income group`)+
theme_bw()
filter(b, Attention == "Network")  %>%
ggplot(aes(Score, `Total Equity Sources`)) +
geom_line()  +
facet_grid(~`Income group`)+
theme_bw()
filter(b, Attention == "Network")  %>%
ggplot(aes(Score, `Total Equity Sources`)) +
geom_bar()  +
facet_grid(~`Income group`)+
theme_bw()
filter(b, Attention == "Network")  %>%
ggplot(aes(Score, `Total Equity Sources`)) +
geom_point()  +
facet_grid(~`Income group`)+
theme_bw()
b$`Income group` <- gsub("(^|[[:space:]])([[:alpha:]])", "\\1\\U\\2", b$`Income group`, perl=TRUE)
filter(b, Attention == "Network")  %>%
ggplot(aes(Score, `Total Equity Sources`)) +
geom_point()  +
facet_grid(~`Income group`)+
theme_bw()
filter(b, Attention == "Network")  %>%
group_by(country) %>%
mutate(`Average Equity Sources` = mean(`Total Equity Sources`))
filter(b, Attention == "Network")  %>%
group_by(Country) %>%
mutate(`Average Equity Sources` = mean(`Total Equity Sources`))
filter(b, Attention == "Network")  %>%
group_by(Country) %>%
mutate(`Average Equity Sources` = mean(`Total Equity Sources`)) %>%
ggplot(aes(Score, `Average Equity Sources`)) +
geom_point()  +
facet_grid(~`Income group`)+
theme_bw()
filter(b, Attention == "Network")  %>%
group_by(Country) %>%
mutate(`Average Equity Sources` = mean(`Total Equity Sources`)) %>%
ggplot(aes(Score, `Average Equity Sources`))
filter(b, Attention == "Network")  %>%
group_by(Country) %>%
mutate(`Average Equity Sources` = mean(`Total Equity Sources`)) %>%
ggplot(aes(Score, `Average Equity Sources`)) +
geom_point()
filter(b, Attention == "Network")  %>%
group_by(Country) %>%
mutate(`Average Equity Sources` = mean(`Total Equity Sources`)) %>%
ggplot(aes(Score, `Average Equity Sources`)) +
geom_line()
filter(b, Attention == "Network")  %>%
group_by(Country) %>%
mutate(`Average Equity Sources` = mean(`Total Equity Sources`)) %>%
ggplot(aes(Score, `Average Equity Sources`)) +
geom_point()
filter(b, Attention == "Network")  %>%
group_by(Country) %>%
mutate(`Average Equity Sources` = mean(`Total Equity Sources`))
filter(b, Attention == "Network")  %>%
ggplot(aes(Score, `Average Equity Sources`)) +
geom_point()  +
facet_grid(~`Income group`)+
theme_bw()
filter(b, Attention == "Network")  %>%
ggplot(aes(Score, `Total Equity Sources`)) +
geom_point()  +
facet_grid(~`Income group`)+
theme_bw()
b <- gali %>%
select(country, equity_sources_tot, revenue_tot, starts_with("accel_ben_rank_"))
colnames(b) <- c( "Country", "Total Equity Sources", "Revenue", "Network", "Business Skills", "Mentorship", "Investors", "Direct Funding", "Peers", "Credibility")
b <- left_join(b, wb, by = "Country" )
b <- b %>%
pivot_longer(!c("Country", "Total Equity Sources", "Income group", "Region"), names_to = "Attention", values_to = "Score")
b[is.na(b)] <- "High Income"  #The two countries with NA values are USA and UK because of naming issues. They are both classified high income
#Some countries are classified as "High income" while other are "High Income". I will capitilize all first letter to solve this issue
b$`Income group` <- gsub("(^|[[:space:]])([[:alpha:]])", "\\1\\U\\2", b$`Income group`, perl=TRUE)
filter(b, Attention == "Network")  %>%
ggplot(aes(Score, `Total Equity Sources`)) +
geom_point()  +
facet_grid(~`Income group`)+
theme_bw()
filter(b, Attention == "Network")  %>%
ggplot(aes(Score, Revenue)) +
geom_point()  +
facet_grid(~`Income group`)+
theme_bw()
b <- gali %>%
select(country, equity_sources_tot, revenue_tot, starts_with("accel_ben_rank_"))
colnames(b) <- c( "Country", "Total Equity Sources", "Revenue", "Network", "Business Skills", "Mentorship", "Investors", "Direct Funding", "Peers", "Credibility")
b <- left_join(b, wb, by = "Country" )
b <- b %>%
pivot_longer(!c("Country", "Total Equity Sources", "Income group", "Region", "Revenue"), names_to = "Attention", values_to = "Score")
b[is.na(b)] <- "High Income"  #The two countries with NA values are USA and UK because of naming issues. They are both classified high income
#Some countries are classified as "High income" while other are "High Income". I will capitilize all first letter to solve this issue
b$`Income group` <- gsub("(^|[[:space:]])([[:alpha:]])", "\\1\\U\\2", b$`Income group`, perl=TRUE)
filter(b, Attention == "Network")  %>%
ggplot(aes(Score, `Total Equity Sources`)) +
geom_point()  +
facet_grid(~`Income group`)+
theme_bw()
filter(b, Attention == "Network")  %>%
ggplot(aes(Score, Revenue)) +
geom_point()  +
facet_grid(~`Income group`)+
theme_bw()
gali_joined  <- gali_joined %>% mutate(capital_raised0 = gali_joined %>% select(starts_with("inv_") & ends_with("_m1")) %>%
rowSums(na.rm = TRUE))
gali_joined  <- gali_joined %>% mutate(capital_raised1 = gali_joined %>% select(starts_with("fu1inv_") & ends_with("_m1")) %>%
rowSums(na.rm = TRUE))
gali_joined  <- gali_joined %>% mutate(capital_raised2 = gali_joined %>% select(starts_with("fu2inv_") & ends_with("_m1")) %>%
rowSums(na.rm = TRUE))
gali_joined  <- gali_joined %>% mutate(capital_raised3 = gali_joined %>% select(starts_with("fu3inv_") & ends_with("_m1")) %>%
rowSums(na.rm = TRUE))
gali_joined  <- gali_joined %>% mutate(capital_raised4 = gali_joined %>% select(starts_with("fu4inv_") & ends_with("_m1")) %>%
rowSums(na.rm = TRUE))
gali_joined  <- gali_joined %>% mutate(capital_raised_tot = gali_joined %>% select(starts_with("capital_raised")) %>%
rowSums(na.rm = TRUE))
gali  <- gali %>% mutate(capital_raised0 = gali %>% select(starts_with("inv_") & ends_with("_m1")) %>%
rowSums(na.rm = TRUE))
gali  <- gali %>% mutate(capital_raised1 = gali %>% select(starts_with("fu1inv_") & ends_with("_m1")) %>%
rowSums(na.rm = TRUE))
gali  <- gali %>% mutate(capital_raised2 = gali %>% select(starts_with("fu2inv_") & ends_with("_m1")) %>%
rowSums(na.rm = TRUE))
gali  <- gali %>% mutate(capital_raised3 = gali %>% select(starts_with("fu3inv_") & ends_with("_m1")) %>%
rowSums(na.rm = TRUE))
gali  <- gali %>% mutate(capital_raised4 = gali %>% select(starts_with("fu4inv_") & ends_with("_m1")) %>%
rowSums(na.rm = TRUE))
gali  <- gali %>% mutate(capital_raised_tot = gali %>% select(starts_with("capital_raised")) %>%
rowSums(na.rm = TRUE))
b <- gali %>%
select(country, equity_sources_tot, revenue_tot, capital_raised_tot, starts_with("accel_ben_rank_"))
b
b <- gali %>%
select(country, equity_sources_tot, revenue_tot, capital_raised_tot, starts_with("accel_ben_rank_"))
colnames(b) <- c( "Country", "Total Equity Sources", "Revenue", "Capital Raised", "Network", "Business Skills", "Mentorship", "Investors", "Direct Funding", "Peers", "Credibility")
b <- left_join(b, wb, by = "Country" )
b <- b %>%
pivot_longer(!c("Country", "Total Equity Sources", "Income group", "Region", "Revenue"), names_to = "Attention", values_to = "Score")
b[is.na(b)] <- "High Income"  #The two countries with NA values are USA and UK because of naming issues. They are both classified high income
#Some countries are classified as "High income" while other are "High Income". I will capitilize all first letter to solve this issue
b$`Income group` <- gsub("(^|[[:space:]])([[:alpha:]])", "\\1\\U\\2", b$`Income group`, perl=TRUE)
filter(b, Attention == "Network")  %>%
ggplot(aes(Score, `Total Equity Sources`)) +
geom_point()  +
facet_grid(~`Income group`)+
theme_bw()
filter(b, Attention == "Direct funding")  %>%
ggplot(aes(Score, `Capital Raised`)) +
geom_point()  +
facet_grid(~`Income group`)+
theme_bw()
filter(b, Attention == "Direct funding")  %>%
ggplot(aes(Score, `Capital Raised`)) +
geom_point()  +
facet_grid(~`Income group`)+
theme_bw()
filter(b, Attention == "Direct funding")
b
b <- gali %>%
select(country, equity_sources_tot, revenue_tot, capital_raised_tot, starts_with("accel_ben_rank_"))
colnames(b) <- c( "Country", "Total Equity Sources", "Revenue", "Capital Raised", "Network", "Business Skills", "Mentorship", "Investors", "Direct Funding", "Peers", "Credibility")
b <- left_join(b, wb, by = "Country" )
b <- b %>%
pivot_longer(!c("Country", "Total Equity Sources", "Income group", "Region", "Revenue", "Capital Raised"), names_to = "Attention", values_to = "Score")
b[is.na(b)] <- "High Income"  #The two countries with NA values are USA and UK because of naming issues. They are both classified high income
#Some countries are classified as "High income" while other are "High Income". I will capitilize all first letter to solve this issue
b$`Income group` <- gsub("(^|[[:space:]])([[:alpha:]])", "\\1\\U\\2", b$`Income group`, perl=TRUE)
filter(b, Attention == "Network")  %>%
ggplot(aes(Score, `Total Equity Sources`)) +
geom_point()  +
facet_grid(~`Income group`)+
theme_bw()
filter(b, Attention == "Direct Funding")  %>%
ggplot(aes(Score, `Capital Raised`)) +
geom_point()  +
facet_grid(~`Income group`)+
theme_bw()
install.packages("citr")
library(citr)
install.packages("citr")
install.packages("tinytex")
install.packages("tinytex")
