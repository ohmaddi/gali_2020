---
title             : "An institutional approach to attention allocation and venture resource mobilization and acquisition"
shorttitle        : "An institutional approach to venture attention allocation"

author: 
  - name          : "Ouafaa Hmaddi"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : "292A Anstett"
    email         : "ohmaddi@uoregon.edu"
    role:         # Contributorship roles (e.g., CRediT, https://casrai.org/credit/)
      - Conceptualization
      - Writing - Original Draft Preparation
      - Writing - Review & Editing

affiliation:
  - id            : "1"
    institution   : "University of Oregon"

authornote: |
  Lundquist College of Business 

  Department of Management 

abstract: |
  One or two sentences providing a **basic introduction** to the field,  comprehensible to a scientist in any discipline.
  
  
  <!-- https://tinyurl.com/ybremelq -->
  
keywords          : "attention, resources, institutional capital, accelerators"

bibliography      : ["r-references.bib"]

floatsintext      : no
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : yes
mask              : no
draft             : no

documentclass     : "apa6"
classoption       : "man"
output            : papaja::apa6_pdf
---

```{r setup, include = FALSE}
library("papaja")
r_refs("r-references.bib")
```

```{r analysis-preferences}
# Seed for random number generation
set.seed(42)
knitr::opts_chunk$set(cache.extra = knitr::rand_seed)
#options(knitr.table.format = "latex")
```

```{r message=FALSE, warning=FALSE, include=FALSE}
#This is not my code. It is from https://rdrr.io/cran/gdata/src/R/cbindX.R to help me me bind cols of dfs with different number of rows

cbindX <- function(...)
{
  ## --- Setup ---

  x <- list(...)

  ## Are all objects matrices or data.frames?
  test <- sapply(x, function(z) is.matrix(z) | is.data.frame(z))
  if(any(!test)) stop("only matrices and data.frames can be used")

  ## Get maximum number of rows
  tmp <- sapply(x, nrow)
  maxi <- which.max(tmp)
  test <- tmp < tmp[maxi]

  ## --- Core ---

  ## Adding additional "empty" rows so that all objects have the same number of rows
  for(i in 1:length(tmp)) {
    if(test[i]) {
      add <- matrix(nrow=tmp[maxi] - tmp[i], ncol=ncol(x[[i]]))
      if(is.data.frame(x[[i]])) {
        add <- as.data.frame(add)
      }
      colnames(add) <- colnames(x[[i]])
      x[[i]] <- rbind(x[[i]], add)
    }
  }

  ## Column-bind all objects
  ret <- x[[1]]
  for(i in 2:length(tmp)) {
    ret <- cbind(ret, x[[i]])
  }

  ## --- Return ---
  ret
}
```


# Introduction 
Early stage entrepreneurs are faced with a range of resource choices to seek, and must decide what should garner their attention. The literature on entrepreneurial resources argues the resources entrepreneurs possess shape their resource acquisition and once they raise one resource others follow. Thus, one might theorize that founders should focus their attention on the resource they can leverage based on their existing resource endowment. However, resource acquisition depends on both entrepreneurs’ resource endowment and the institutional-level capital. Both are indispensable antecedents that affect the mobilization and acquisition of additional capital. 

The value of a resource varies with its institutional context [@holburn2010political]. On the one hand, strong institutions can increase the value of a resource by streamlining access to complementary external resources [@khanna2001estimating; @north1990institutions]. For example, in countries with strong financing infrastructure, acquiring financing can streamline accessing other resources and thus it would make sense to focus on raising capital at venture’s earliest stages. On the other hand, resources such as legitimation or social capital can substitute for the weak institutions and capital infrastructure, thereby increasing in value when institutions are weak [@khanna1997focused; @kock2001strategy]. Therefore, the broader environment can enhance or inhibit the optimal use of the endowed resource capital. I posit that an examination of both the venture and its broader institutional environment would give us more insights about where founders attention should be allocated. Specifically, I hypothesize that the institutional-level capital positively moderates the relationship between a founder’s attention and its subsequent resource mobilization and acquisition. For example, attention to human capital is more positively related to a higher number of employees in contexts in which it has higher intuitional-level human capital. This similarly applies to social capital, and financial capital as the types of resources sought by entrepreneurs. Thus, in this paper I seek to examine the following research question: How does the alignment of the institutional context and the allocation of entrepreneurial attention toward specific resources influence the venture’s resource mobilization and acquisition? 

# Hypotheses Development 
At the heart of the intersection between resource acquisition and the institutional context is entrepreneurial attention, that is, founders’ attention allocation to resources. Bounded by their limited attentional capacities, entrepreneurs cannot attend to all the resources; rather, they focus on some resources but must ignore others. Where they focus their attention determines the propensity of mobilizing and acquiring resources. A venture could miss the chance to exploit an opportunity of resources acquisition if that opportunity never appears on the entrepreneur’s radar screens because they are too focused on an alternative resource. For example, a voluntary work with potential partners who are well connected to other investors might be missed because the founder is too focused on raising capital by honing their business plan over and over and even paying accounting boutique firms to develop that business plan for them. 

Thus, selective attention plays a crucial role in both individual and organizational behavior because it bounds individual rationality and determines the menu of available actions [@simon1947comment]. The debate over which resource should garner the entrepreneur’s attention concludes that the founding team resource endowment is the key factor that influences resource acquisition. For instance, scholars argue that founding teams with a more ties to potential investors are more likely to gain funding [@shane2002organizational]. Furthermore, if we focus on the findings of the stream of research examining the performance implications of acquiring financial capital [@hochberg2007whom] we would expect that early-stage financing should be most likely to garner founders’ attention. However, the role of the institutional context has been ignored and neglected in this debate. I argue that selective attention allocation depends on both entrepreneur’s resource endowment and institutional capital.

Therefore, I state the following hypotheses about the relationship between the congruence level of the entrepreneurs' attention to resources and the institutional level capital, and the venture's resource mobilization, acquisition, and performance. 

**Hypothesis 1** *The higher the level of congruency of venture’s attention to a resource and its institutional level capital, the higher the odds of mobilization that resource* 

**Hypothesis 2** *The higher the level of congruency of venture’s attention to a resource and its institutional level capital, the higher the level of the accumulated resource* 

**Hypothesis 3** *The higher the level of congruency of venture’s attention to a resource and its institutional level capital, the higher the venture performance* 


# Analysis

## Measures

**Predictors**

*Venture attention to a resource* A common approach to measure attention allocation is to use the revealed preference of individuals to evaluate the attention structure [@gebauer2009attention]. I use the entrepreneurs’ ranked preference of the desired benefits from accelerator programs as a proxy for the attention allocation of the early-stage ventures to various resources. The GALI questionnaire asks applying entrepreneurs to rank seven acceleration benefits by perceived importance to their ventures. The seven benefits are network development (Network), e.g. with potential partners and customers, business skill development (Business Skills), mentorship from business experts (Mentorship), indirect funding through access to potential investors/funders (Access to Investors), securing direct venture funding (Direct Funding), gaining access to a group of like-minded entrepreneurs (Access to Like-minded Entrepreneurs), and awareness and credibility (Awareness and Credibility). Setting aside Awareness and Credibility and Access to Like-minded Entrepreneurs, the remaining five benefits can be categorized into three types of resources. Mentorship and Business Skills represent the development of human capital. Network help develop social capital. Direct Funding and Access to Investors improve the financial capital of early-stage ventures directly or indirectly.

Respondents are asked to rank the seven benefits on a scale from one to seven, with one being the most important and seven being the least important. These rankings were reverse-coded to facilitate interpretation of the effects in order of increased importance, with 1 being the least important and 7 the most important. The benefits that accelerators provide consistently ranked in the top three were network development, business skills development, and securing direct venture funding. I assume that the early-stage ventures’ attention allocation reflects the rankings given in their questionnaires. The questionnaire enforces a rule that respondents need to enter a ranking for all seven benefits and no tie is allowed. I exclude observations that do not have complete ranking of the seven items or because they have ties in the rankings.

*Institutional level capital* To measure the level of capital of a certain resource at the country level, I used data from the World Economic Forum Global Competitiveness Index (GCI). Specificaly, I used the variable State of cluster development as a measure for institutional level social capital; Ease of finding skilled employees as a measure for institutional level human capital; and Venture capital (VC) availability, Financing of Small and Medium Enterprises (SMEs), Domestic Credit Gaps as different measures of institutional level financial capital. While former measures of fiancial capital are self-explanatory, the latter variable is defined loans, purchases of non-equity securities, and trade credits and other accounts receivable provided to the private sector by financial corporations as a percentage of gross domestic products (GDP). 

**Outcomes**

*Resource mobilization* is coded as a dichotomous measure *Participated* equal to one
if an applicant participate to an accelerator program of choice, and zero otherwise. I assume that pariticipating to an acceleration program is the first step to mobiliza all types of resources provided by the accelerator.  

*Resource acquisition* once participants mobilize resources through participation to an accelerator, they engage in acquiring resources that garner their attention. These resources can translate into (a) raising capital from one source or many sources depending on (b) the entrepreneurs social capital (i.e. Network) or (c) hiring employees. (a), (b), and (c) are all resource acquisition outcomes. 

*Performance* finaly to measure the impact on venture performance, I use the variable *Revenue* as a proxy for this outcome. This is the most commonly used performance indicator in the management in strategy litrature. 

**Control Variables**

*Human Capital Index* consists of educational attainment, prior career experience in executive positions (C-level positions), team tenure, and prior founding experience [@colombo2005founders; @dimov2005human; @estrin2016human]. I measure the educational attainment of a founding team by calculating the percentage of founders with a graduate degree in the founding team (Graduate Percentage). Prior career experience in C-level executive positions (Prior C-level Executive Percentage) is measured by the percentage of founders in the founding teams holding C-level executive positions prior to the current venture. Average Team Tenure measures the average working years of the founding team members. Team Prior Founding measures the number of organizations founded by the founding team before the current venture.

To create an index, I use the quantile normalization technique to reduce the effect of extreme values while preserving the sequence of an observation in each variable [@hansen2012removing]. Quantile normalization makes two or more distributions identical in statistical properties, such as maximum, minimum, and mean, without a reference distribution. It maintains the order, namely quantile, of observations in each variable treated but the values are normalized with respect to values from other variables at the same quantile. After doing so, the extreme values observed in some variables are smoothed out while the order is preserved, allowing us to explore the effect of each variable more accurately. I first z-standardize the above-mentioned variables. Then, I use the {preprocessCore} package to conduct quantile normalization by sets of variables. I then rescale the index to a range between 0 and 1.

*Gender composition* the proportion female co-founders in each venture team. 

## Data
The dataset from the Global Accelerator Learning Initiative (GALI) covers entrepreneurs who applied to scores of accelerators that began accepting applications between 2013 and 2020. Our data include information – collected during program applications – about ventures, founding teams, and pre-program performance. They also identify which applicants went on to participate in each program. Finally, these data include follow-up information collected from selected and rejected applicants in the years following each application window. The anonymized dataset containing both application and follow-up data can be accessed at [GALI Data](www.galidata.org/data-request). This is multi-country dataset. It typically contains hundreds of ventures per country. 

When entrepreneurs apply to a GALI-participating accelerator, they are asked to complete a standardized survey which asks basic questions about their venture’s business model, financial performance, and founding team. Then, after one year, they are asked to complete a follow-up survey, whether or not they were accepted into the program to which they applied. 



I set aside XXX nonprofit organizations and XXX observations that are missing relevant venture information or preference ranking, resulting in xxx observations in the final sample. All financial statistics are in United States Dollars (USD). ********

## Methods
The ventures in our sample are nested within countries. To account for such nested (or hierarchical) structure of the data, I opt for a linear mixed effects model to estimate the effects of each resource alone and when it interacts with institutional level of the resource.  This helps us account for fixed effects and random effects associated with non-nested grouping factors. Namely, it allows us to take into account the institutional (i.e. country) effect on venture outcomes and quantify the extent to which differences in outcomes reflect differences in the effects of country-specific features, specifically institutional level capital. 

The following equation (formulas) show all the models by outcome category. Of note, I run all the following models with conrols and without controls as robustness check. Control vriables are HCI refering to Human Capital Index and GC refering to Gender composition (i.e. female percentage in a team). 

**Resource mobilization**

(1)	*Participated ~  AHC + (AHC | Country)    ; AHC = Attention to Human Capital* 
(2)	*Participated ~  AHC + (AHC x Ease of finding skilled employees | Country)*
(3)	*Participated ~  AFC + (AFC | Country)   ; AHC = Attention to Financial Capital*
(4)	*Participated ~  AFC + (AFC x Financing of SMEs| Country)*   
(5)	*Participated ~  AFC + (AFC x VC availability | Country)*   
(6)	*Participated ~  AFC + (AFC x Domestic Credit Gaps | Country)*   
(7)	*Participated ~  ASC + (ASC | Country) ; ASC = Attention to Social Capital*   
(8)	*Participated ~  ASC + (ASC x State of cluster development | Country)*   

**Resource acquisition** 

(9) *Total employees ~ AHC + (AHC | Country)*
(10) *Total employees ~ AHC + (AHC x Ease of finding skilled employees | Country)*
(11) *Capital Raised ~ AFC + (AFC | Country)* 
(12) *Capital Raised ~ AFC + (AFC x Financing of SMEs| Country)*
(13) *Capital Raised ~ AFC + (AFC x VC availability | Country)*
(14) *Capital Raised ~ AFC + (AFC x VC availability | Country)*
(15) *Capital sources ~ ASC + (ASC | Country)*   
(16) *Capital sources ~  ASC + (ASC x State of cluster development | Country)*  

**Performance** 

(17)	*Revenue ~  AHC + (AHC | Country)* 
(18)	*Revenue ~  AHC + (AHC x Ease of finding skilled employees | Country)*
(19)	*Revenue ~  AFC + (AFC | Country)*
(20)	*Revenue ~  AFC + (AFC x Financing of SMEs| Country)*   
(21)	*Revenue ~  AFC + (AFC x VC availability | Country)*   
(22)	*Revenue ~  AFC + (AFC x Domestic Credit Gaps | Country)*   
(23)	*Revenue ~  ASC + (ASC | Country)*   
(24)	*Revenue ~  ASC + (ASC x State of cluster development | Country)*


## Data analysis
I used `r cite_r("r-references.bib")` for all our analyses.
```{r message=FALSE, warning=FALSE, include=FALSE}
library(rio)
library(tidyverse)
library(janitor)
library(ggplot2)
library(psych)
library(knitr)
library(preprocessCore)
library(kableExtra)

```

```{r Countries to analyse in main sample, message=FALSE, warning=FALSE, include=FALSE}
gali <- import("Data/GALI_External_DataRelease_2020.xlsx") 
wb <- import("Data/CLASS.xls")
count(gali,info_venture_country_hq)

#Removing countries with less than 6 ventures. 

countries_to_keep <- gali %>% 
  group_by(gali$info_venture_country_hq) %>%
  summarize(Count=n()) %>%
  mutate(Percent = round((Count/sum(Count)*100))) %>%
  arrange(desc(Count))

countries_to_keep <- filter(countries_to_keep, `gali$info_venture_country_hq` != 'NA')

countries_to_keep <- filter(countries_to_keep, Count >9)
countries_to_keep$`gali$info_venture_country_hq`

gali <- gali %>%
  filter(info_venture_country_hq  %in% countries_to_keep$`gali$info_venture_country_hq`)

```

```{r message=FALSE, warning=FALSE, include=FALSE}
gali <- filter(gali, found_name1_age > 14 | is.na(found_name1_age))
gali <- filter(gali, found_name2_age > 14 | is.na(found_name2_age))
gali <- filter(gali, found_name3_age > 14 | is.na(found_name3_age))
gali <- filter(gali, found_name1_age < 70 | is.na(found_name1_age))
gali <- filter(gali, found_name2_age < 70 | is.na(found_name2_age))
gali <- filter(gali, found_name3_age < 70 | is.na(found_name3_age))

#Keep only for porfit firms 
gali <- filter(gali, info_legal_status == "For-profit company" ) 


#firms that are 5 years or younger when they entered the acceleration program (when data was collected)

if (gali$application_year == 2013) { gali <- filter(gali, info_founding_year > 2007)
}  else if (gali$application_year == 2014) {gali <- filter(gali, info_founding_year > 2008)
} else if (gali$application_year == 2015) {gali <- filter(gali, info_founding_year > 2009)
}  else if (gali$application_year == 2016) {gali <- filter(gali, info_founding_year > 2010)
} else if (gali$application_year == 2017) {gali <- filter(gali, info_founding_year > 2011)
}  else gali <- filter(gali, info_founding_year > 2012)
```

```{r Countries to keep in sample with valid data, message=FALSE, warning=FALSE, include=FALSE}

gali <- gali %>%
  rename(country = info_venture_country_hq) %>%
  rename(year = program_year)

gali$country[gali$country == "United States of America"] <-"USA"
gali$country[gali$country == "Tanzania, United Republic of"] <-"Tanzania"

countries_to_keep <- gali %>% 
  group_by(gali$country) %>%
  summarize(Count=n()) %>%
  mutate(Percent = round((Count/sum(Count)*100))) %>%
  arrange(desc(Count))

countries_to_keep <- filter(countries_to_keep, `gali$country` != 'NA')

countries_to_keep <- filter(countries_to_keep, Count >9)
countries_to_keep$`gali$country`

gali <- gali %>%
  filter(country  %in% countries_to_keep$`gali$country`)


```

#CGI data
```{r message=FALSE, warning=FALSE, include=FALSE}
gci <- import("Data/GCI_2018.xlsx")

gci <- filter(gci, `Series Global ID` == "EOSQ089" |
                   `Series Global ID` == "EOSQ425" |
                   `Series Global ID` == "EOSQ109" |
                   `Series Global ID` == "DOMCREDITGDP" |
                   `Series Global ID` == "EOSQ403")
gci <- filter(gci, Edition ==2018 )

gci <- filter(gci, Attribute == "VALUE")
gci <- select(gci, -c("Index", "Edition", "Freeze date", "Series units", "Series order", "Series code (if applicable)", "Attribute", "Series name"))

gci <- gci %>%
  gather(country, score, -`Series Global ID`) 

gci$country[gci$country == "United States"] <-"USA"

gci <- gci %>%
  filter(country  %in% countries_to_keep$`gali$country`)

gci$score <- round(as.numeric(gci$score),2)

gci <- clean_names(gci)

gci <- gci %>%
  pivot_wider(names_from = series_global_id, 
              values_from = score)
```

#Plotting all countries along the 3 dimensions 

```{r echo=FALSE, fig.height=10, fig.width=10, message=FALSE, warning=FALSE}

library(plot3D)

with(gci, text3D(EOSQ403, EOSQ425, EOSQ109, 
  labels = gci$country,  
  col = gg.col(100), theta = 60, phi = 20,
  xlab = "Human capital", ylab = "Financial capital", zlab = "Social capital", 
  main = "Institutional level resources", cex = 0.6, 
  bty = "g", ticktype = "detailed", d = 2,
  clab = c("Urban","Pop"), adj = 1, font = 1.5))

#Zoom into to the middle for more clarity 
plotdev(xlim = c(3, 4), ylim = c(3, 5.5), 
         zlim = c(3, 3.8))

```

```{r Cleaning data of acceleration benefit ranking, message=FALSE, warning=FALSE, include=FALSE}

## Attention to capital - venture data

#Removing ventures that ranked benefits outside of given scale (i.e. 1 to 7)

gali <- filter(gali, accel_ben_rank_network <= 7 & accel_ben_rank_business_skills
<= 7 & accel_ben_rank_mentorship <= 7 & accel_ben_rank_access_investors <= 7 & accel_ben_rank_direct_funding <= 7 & accel_ben_rank_access_entreprene <= 7 & accel_ben_rank_aware_cred <= 7 ) 

#Removing ventures that gave the same ranking to two or more benefits 
gali <- filter(gali, 
               accel_ben_rank_network != accel_ben_rank_business_skills &
                 accel_ben_rank_network != accel_ben_rank_mentorship & 
                 accel_ben_rank_network != accel_ben_rank_access_investors &
                 accel_ben_rank_network != accel_ben_rank_direct_funding &
                 accel_ben_rank_network != accel_ben_rank_access_entreprene &
                 accel_ben_rank_network != accel_ben_rank_aware_cred ) 

gali <- filter(gali, 
                 accel_ben_rank_business_skills != accel_ben_rank_mentorship & 
              accel_ben_rank_business_skills != accel_ben_rank_access_investors &
                 accel_ben_rank_business_skills != accel_ben_rank_direct_funding &
              accel_ben_rank_business_skills != accel_ben_rank_access_entreprene &
                 accel_ben_rank_business_skills != accel_ben_rank_aware_cred ) 

gali <- filter(gali, 
                accel_ben_rank_mentorship != accel_ben_rank_access_investors &
                 accel_ben_rank_mentorship != accel_ben_rank_direct_funding &
                 accel_ben_rank_mentorship != accel_ben_rank_access_entreprene &
                 accel_ben_rank_mentorship != accel_ben_rank_aware_cred ) 

gali <- filter(gali, 
              accel_ben_rank_access_investors != accel_ben_rank_direct_funding &
            accel_ben_rank_access_investors != accel_ben_rank_access_entreprene &
                 accel_ben_rank_access_investors != accel_ben_rank_aware_cred ) 

gali <- filter(gali, 
              accel_ben_rank_direct_funding != accel_ben_rank_access_entreprene &
                 accel_ben_rank_direct_funding != accel_ben_rank_aware_cred )

gali <- filter(gali, 
              accel_ben_rank_access_entreprene != accel_ben_rank_aware_cred )

```



```{r Human capital index}
##Control variables 

##Constrcuting human capital index (control variable)
###Graduate percentage, Prior C-level Executive Percentage, Average Team Tenure , Team Prior Founding 

#Graduate percentage

gali$founder1_grad = ifelse(gali$found_name1_education == "Masters Degree" | 
                              gali$found_name1_education =="PhD" |
                              gali$found_name1_education == "Some graduate degree", 1, 0) 
gali$founder1_grad[is.na(gali$founder1_grad)] <- 0

gali$founder2_grad = ifelse(gali$found_name2_education == "Masters Degree" | 
                              gali$found_name2_education =="PhD" |
                              gali$found_name2_education == "Some graduate degree", 1, 0) 
gali$founder2_grad[is.na(gali$founder2_grad)] <- 0

gali$founder3_grad = ifelse(gali$found_name3_education == "Masters Degree" |
                              gali$found_name3_education =="PhD" |
                              gali$found_name3_education == "Some graduate degree", 1, 0)
gali$founder3_grad[is.na(gali$founder3_grad)] <- 0

gali$nb_of_founders <- gali$found_name1_present + gali$found_name2_present + gali$found_name3_present

gali <- filter(gali, nb_of_founders > 0)

gali$grad_pct = ((gali$founder1_grad + gali$founder2_grad + gali$founder3_grad) / gali$nb_of_founders) 

#Prior C-level Executive Percentage

gali$founder1_job1_clevel = ifelse(is.na(gali$found_name1_job1_role) | gali$found_name1_job1_role !=  "CEO/Executive Director" , 0, 1)
gali$founder1_job2_clevel = ifelse(is.na(gali$found_name1_job2_role) | gali$found_name1_job2_role !=  "CEO/Executive Director" , 0, 1)
gali$founder2_job1_clevel = ifelse(is.na(gali$found_name2_job1_role) | gali$found_name2_job1_role !=  "CEO/Executive Director" , 0, 1)
gali$founder2_job2_clevel = ifelse(is.na(gali$found_name2_job2_role) | gali$found_name2_job2_role !=  "CEO/Executive Director" , 0, 1)
gali$founder3_job1_clevel = ifelse(is.na(gali$found_name3_job1_role) | gali$found_name3_job1_role !=  "CEO/Executive Director" , 0, 1)
gali$founder3_job2_clevel = ifelse(is.na(gali$found_name3_job2_role) | gali$found_name3_job2_role !=  "CEO/Executive Director" , 0, 1)

gali$prior_clevel_pct = ((gali$founder1_job1_clevel + gali$founder1_job2_clevel + gali$founder2_job1_clevel + 
  gali$founder2_job2_clevel + gali$founder3_job1_clevel + gali$founder3_job2_clevel) / (gali$nb_of_founders*2)) 

#Average Team Tenure

gali$avg_teamtenure <- rowMeans(subset(gali, select = c('found_name1_job1_tenure', 'found_name1_job2_tenure', 'found_name2_job1_tenure', 'found_name2_job2_tenure', 'found_name3_job1_tenure', 'found_name3_job2_tenure')), na.rm = TRUE)  

gali$avg_teamtenure[is.nan(gali$avg_teamtenure)] <- 0

#Team Prior Founding
gali$team_prior_founding <- gali$found_name1_prior_fp + gali$found_name2_prior_fp + gali$found_name3_prior_fp + gali$found_name1_prior_other + gali$found_name2_prior_other + gali$found_name3_prior_other + gali$found_name1_prior_np + gali$found_name2_prior_np + gali$found_name3_prior_np 

#Final Human Capital Index 

gali$z_team_prior_founding <- scale(gali$team_prior_founding, center = TRUE, scale = TRUE)
gali$z_prior_clevel_pct <- scale(gali$prior_clevel_pct, center = TRUE, scale = TRUE)
gali$z_avg_teamtenure <- scale(gali$avg_teamtenure, center = TRUE, scale = TRUE)
gali$z_grad_pct <- scale(gali$grad_pct, center = TRUE, scale = TRUE)

#Cite Bolstad et al, Bioinformatics (2003) 

gali$normq_team_prior_founding <- normalize.quantiles(gali$z_team_prior_founding,copy=TRUE)
gali$normq_prior_clevel_pct <- normalize.quantiles(gali$z_prior_clevel_pct,copy=TRUE)
gali$normq_avg_teamtenure <- normalize.quantiles(gali$z_avg_teamtenure,copy=TRUE)
gali$normq_grad_pct <- normalize.quantiles(gali$z_grad_pct,copy=TRUE)

#group all into an index 

gali$HC_index <- (gali$normq_team_prior_founding + gali$normq_prior_clevel_pct + gali$normq_avg_teamtenure + gali$normq_grad_pct) 

```

```{r Gender decomposition variable}
##Gender composition variable 

gali <- gali %>% drop_na(found_name1_gender)

gali$found_name2_gender[is.na(gali$found_name2_gender)] <- 0
gali$found_name3_gender[is.na(gali$found_name3_gender)] <- 0

gali$founder1_f <- ifelse(gali$found_name1_gender == "F", 1,0)
gali$founder2_f <- ifelse(gali$found_name2_gender == "F", 1,0)
gali$founder3_f <- ifelse(gali$found_name3_gender == "F", 1,0)

gali$female_pct <- round(((gali$founder1_f + gali$founder2_f + gali$founder3_f) / gali$nb_of_founders ), 2)

```

```{r message=FALSE, warning=FALSE, include=FALSE}
#Reverse code attention variable 

#Reverse code fundtion 
reverse <- function(x){x*-1 +8}

gali_att <- as.data.frame(lapply(gali %>%
                            select(starts_with("accel_ben_rank_")), reverse))

gali <- cbind(gali %>%
        select(-starts_with("accel_ben_rank_")), gali_att)

```

```{r fig.height=5, fig.width=8}
#Distribution of attention 

a <- gali %>%
  select(country, starts_with("accel_ben_rank_")) 

colnames(a) <- c( "Country", "Network", "Business Skills", "Mentorship", "Investors", "Direct Funding", "Peers", "Credibility") 

a <- left_join(a, wb, by = "Country" )

a <- a %>%
  pivot_longer(!c("Country", "Region","Income group"), names_to = "Attention", values_to = "Score")

a[is.na(a)] <- "High Income"  #The two countries with NA values are USA and UK because of naming issues. They are both classified high income

a  %>%
  ggplot(aes(Score)) +
  geom_bar() +
  facet_grid(~Attention) +
  theme_bw()

#Some countries are classified as "High income" while other are "High Income". I will capitilize all first letter to solve this issue

simpleCap <- function(x) {
  s <- strsplit(x, " ")[[1]]
  paste(toupper(substring(s, 1,1)), substring(s, 2),
      sep="", collapse=" ")
}


a$`Income group` <- gsub("(^|[[:space:]])([[:alpha:]])", "\\1\\U\\2", a$`Income group`, perl=TRUE)

a  %>%
  ggplot(aes(Score)) +
  geom_bar() +
  facet_grid(vars(`Income group`), vars(Attention)) +
  theme_bw() 

```

```{r message=FALSE, warning=FALSE, include=FALSE}
#Revenues

gali <- gali %>% mutate(revenue_tot = gali %>%
                         select(contains("revenues")) %>% 
                         rowSums(na.rm = TRUE))
```

```{r message=FALSE, warning=FALSE, include=FALSE}
#Human capital acquisition

gali  <- gali %>% mutate(hr_tot = gali %>%
                         select(contains("_employees")) %>% 
                         rowSums(na.rm = TRUE))
```

```{r message=FALSE, warning=FALSE, include=FALSE}
#Social capital acquisition
gali <- gali %>% mutate(equity_sources_tot = gali %>%
                         select(contains("equityfrom")) %>% 
                         rowSums(na.rm = TRUE))
```

```{r message=FALSE, warning=FALSE, include=FALSE}
#Fiancial Capital acquisiton total
gali  <- gali %>% mutate(capital_raised0 = gali %>% select(starts_with("inv_") & ends_with("_m1")) %>% 
                         rowSums(na.rm = TRUE))

gali  <- gali %>% mutate(capital_raised1 = gali %>% select(starts_with("fu1inv_") & ends_with("_m1")) %>% 
                         rowSums(na.rm = TRUE))

gali  <- gali %>% mutate(capital_raised2 = gali %>% select(starts_with("fu2inv_") & ends_with("_m1")) %>% 
                         rowSums(na.rm = TRUE))

gali  <- gali %>% mutate(capital_raised3 = gali %>% select(starts_with("fu3inv_") & ends_with("_m1")) %>% 
                         rowSums(na.rm = TRUE))

gali  <- gali %>% mutate(capital_raised4 = gali %>% select(starts_with("fu4inv_") & ends_with("_m1")) %>% 
                         rowSums(na.rm = TRUE))

gali  <- gali %>% mutate(capital_raised_tot = gali %>% select(starts_with("capital_raised")) %>% 
                         rowSums(na.rm = TRUE))

```

```{r}
#Predictor and outcome plots 

b <- gali %>%
  select(country, equity_sources_tot, revenue_tot, capital_raised_tot, starts_with("accel_ben_rank_")) 

colnames(b) <- c( "Country", "Total Equity Sources", "Revenue", "Capital Raised", "Network", "Business Skills", "Mentorship", "Investors", "Direct Funding", "Peers", "Credibility") 

b <- left_join(b, wb, by = "Country" )

b <- b %>%
  pivot_longer(!c("Country", "Total Equity Sources", "Income group", "Region", "Revenue", "Capital Raised"), names_to = "Attention", values_to = "Score")

b[is.na(b)] <- "High Income"  #The two countries with NA values are USA and UK because of naming issues. They are both classified high income

#Some countries are classified as "High income" while other are "High Income". I will capitilize all first letter to solve this issue


b$`Income group` <- gsub("(^|[[:space:]])([[:alpha:]])", "\\1\\U\\2", b$`Income group`, perl=TRUE)

filter(b, Attention == "Network")  %>%
  ggplot(aes(Score, `Total Equity Sources`)) +
  geom_point()  +
  facet_grid(~`Income group`)+
  theme_bw()

filter(b, Attention == "Direct Funding")  %>%
  ggplot(aes(Score, `Capital Raised`)) +
  geom_point()  +
  facet_grid(~`Income group`)+
  theme_bw()

```

```{r message=FALSE, warning=FALSE, include=FALSE}

mean_norm_minmax <- function(x){
                                (x- mean(x)) /(max(x)-min(x))
                               }

mean_norm_att <- as.data.frame(lapply(gali %>%
                            select(starts_with("accel_ben_rank_")), mean_norm_minmax))

gali <- cbind(gali %>%
        select(-starts_with("accel_ben_rank_")), mean_norm_att)
```

```{r message=FALSE, warning=FALSE, include=FALSE}
#Join all 3 datasets 
gali_joined <- left_join(gali, gci, by = "country")
```

```{r message=FALSE, warning=FALSE}
# Results

#Function to extract coefficients of summary table

summary_table <- function(x){ x$coefficients %>%
  as.data.frame %>%
    rename(
      "$b$" = "Estimate"
    , "SE" = "Std. Error"
    , "$t$" = "t value"
    , "$p$" = "Pr(>|t|)"
  ) %>%
  mutate(
    Effect = papaja:::prettify_terms(rownames(.))
  ) %>%
  printnum(
    digits = c(2, 2, 2, 3)
    , gt1 = c(TRUE, TRUE, TRUE, TRUE, FALSE, FALSE)
    , zero = c(TRUE, TRUE, TRUE, TRUE, FALSE, FALSE)
  ) %>%
  select(Effect, `$b$`, `SE`, `$t$`, `$p$`)}

#for glmer

summary_table_z <- function(x){ x$coefficients %>%
  as.data.frame %>%
    rename(
      "$b$" = "Estimate"
    , "SE" = "Std. Error"
    , "$z$" = "z value"
    , "$p$" = "Pr(>|z|)"
  ) %>%
  mutate(
    Effect = papaja:::prettify_terms(rownames(.))
  ) %>%
  printnum(
    digits = c(2, 2, 2, 3)
    , gt1 = c(TRUE, TRUE, TRUE, TRUE, FALSE, FALSE)
    , zero = c(TRUE, TRUE, TRUE, TRUE, FALSE, FALSE)
  ) %>%
  select(Effect, `$b$`, `SE`, `$z$`, `$p$`)}

```


```{r echo=FALSE, message=FALSE, warning=FALSE}
#Outcome: resource mobilization 
#Models
library(lme4)
fit0hc <- glmer(participated ~  accel_ben_rank_business_skills + (accel_ben_rank_business_skills|country), data = gali_joined, family=binomial)

fit0hc_c <- glmer(participated ~  accel_ben_rank_business_skills + (accel_ben_rank_business_skills|country) + HC_index + female_pct, data = gali_joined, family=binomial)

fit1hc <- glmer(participated ~  accel_ben_rank_business_skills*EOSQ403 + (accel_ben_rank_business_skills|country), data = gali_joined, family=binomial)

fit1hc_c <- glmer(participated ~  accel_ben_rank_business_skills*EOSQ403 + (accel_ben_rank_business_skills|country)+ HC_index + female_pct, data = gali_joined, family=binomial)

fit0fc <- glmer(participated ~  accel_ben_rank_direct_funding + (accel_ben_rank_direct_funding|country), data = gali_joined, family=binomial)

fit0fc_c <- glmer(participated ~  accel_ben_rank_direct_funding + (accel_ben_rank_direct_funding|country)+ HC_index + female_pct, data = gali_joined, family=binomial)

fit1fc <- glmer(participated ~ accel_ben_rank_direct_funding*EOSQ425 + (accel_ben_rank_direct_funding |country ), data = gali_joined, family=binomial)

fit1fc_c <- glmer(participated ~ accel_ben_rank_direct_funding*EOSQ425 + (accel_ben_rank_direct_funding |country )+ HC_index + female_pct, data = gali_joined, family=binomial)

fit2fc <- glmer(participated ~ accel_ben_rank_direct_funding*EOSQ089 + (accel_ben_rank_direct_funding |country ), data = gali_joined, family=binomial)

fit2fc_c <- glmer(participated ~ accel_ben_rank_direct_funding*EOSQ089 + (accel_ben_rank_direct_funding |country )+ HC_index + female_pct, data = gali_joined, family=binomial)

fit3fc <- glmer(participated ~ accel_ben_rank_direct_funding*DOMCREDITGDP + (accel_ben_rank_direct_funding |country), data = gali_joined, family=binomial)

fit3fc_c <- glmer(participated ~ accel_ben_rank_direct_funding*DOMCREDITGDP + (accel_ben_rank_direct_funding |country)+ HC_index + female_pct, data = gali_joined, family=binomial)

fit0sc <- glmer(participated ~ accel_ben_rank_network + (accel_ben_rank_network |country), data = gali_joined, family=binomial)

fit0sc_c <- glmer(participated ~ accel_ben_rank_network + (accel_ben_rank_network |country)+ HC_index + female_pct, data = gali_joined, family=binomial)

fit1sc <- glmer(participated ~ accel_ben_rank_network*EOSQ109 + (accel_ben_rank_network | country), data = gali_joined, family=binomial)

fit1sc_c <- glmer(participated ~ accel_ben_rank_network*EOSQ109 + (accel_ben_rank_network | country)+ HC_index + female_pct, data = gali_joined, family=binomial)

```

```{r message=FALSE, warning=FALSE}
#Summary tables

hc0 <- summary_table_z(summary(fit0hc))
hc0_c <- summary_table_z(summary(fit0hc_c))
hc1 <- summary_table_z(summary(fit1hc))
hc1_c <- summary_table_z(summary(fit1hc_c))
fc0 <- summary_table_z(summary(fit0fc))
fc0_c <- summary_table_z(summary(fit0fc_c))
fc1 <- summary_table_z(summary(fit1fc))
fc1_c <- summary_table_z(summary(fit1fc_c))
fc2 <- summary_table_z(summary(fit2fc))
fc2_c <- summary_table_z(summary(fit2fc_c))
fc3 <- summary_table_z(summary(fit3fc))
fc3_c <- summary_table_z(summary(fit3fc_c))
sc0 <- summary_table_z(summary(fit0sc))
sc0_c <- summary_table_z(summary(fit0sc_c))
sc1 <- summary_table_z(summary(fit1sc))
sc1_c <- summary_table_z(summary(fit1sc_c))

rownames(hc0) <- c("Intercept","Attention to Human capital(AHC)")
rownames(hc0_c) <- c("Intercept","Attention to Human capital(AHC)", "HCI", "GC")
#rownames(hc1) <- c("Intercept","AHC", "Ease of finding skilled employees", "AHCxEase of finding skilled employees")
rownames(hc1_c) <- c("Intercept","AHC", "Ease of finding skilled employees", "AHCxEase of finding skilled employees", "HCI", "GC")
#rownames(fc0) <- c("Intercept","Attention to Financial capital")
rownames(fc0_c) <- c("Intercept","Attention to Financial capital", "HCI", "GC")
#rownames(fc1) <- c("Intercept","AFC", "Financing of SMEs", "AFCxFinancing of SMEs")
rownames(fc1_c) <- c("Intercept","AFC", "Financing of SMEs", "AFCxFinancing of SMEs", "HCI", "GC")
#rownames(fc2) <- c("Intercept","AFC", "VC Availability", "AFCxVC Availability")
rownames(fc2_c) <- c("Intercept","AFC", "VC Availability", "AFCxVC Availability", "HCI", "GC")
#rownames(fc3) <- c("Intercept","AFC", "Domestic Credit Gaps", "AFCxDomestic Credit Gaps")
rownames(fc3_c) <- c("Intercept","AFC", "Domestic Credit Gaps", "AFCxDomestic Credit Gaps", "HCI", "GC")
#rownames(sc0) <- c("Intercept","Attention to Social capital")
rownames(sc0_c) <- c("Intercept","Attention to Social capital", "HCI", "GC")
#rownames(sc1) <- c("Intercept","ASC", "State of cluster development","ASCxState of cluster development")
rownames(sc1_c) <- c("Intercept","ASC", "State of cluster development","ASCxState of cluster development", "HCI", "GC")

hc_zero <- cbindX(hc0_c[,-1], hc0[,-1]) 
hc_one <- cbindX(hc1_c[,-1], hc1[,-1]) 
fc_zero <- cbindX(fc0_c[,-1], fc0[,-1]) 
fc_one <- cbindX(fc1_c[,-1], fc1[,-1])
fc_two <- cbindX(fc2_c[,-1], fc2[,-1]) 
fc_three <- cbindX(fc3_c[,-1], fc3[,-1]) 
sc_zero <- cbindX(sc0_c[,-1], sc0[,-1]) 
sc_one <- cbindX(sc1_c[,-1], sc1[,-1]) 

```

```{r }
#Print summaries 

kable(hc_zero, booktabs = T, caption = "Table 1: Effect of attention to human capital", escape = F) %>%
  add_header_above(c(" ", "Model w/ controls" = 4, "Model w/o controls" = 4), italic = T) %>%
  kable_styling(latex_options = c("repeat_header")) %>%
  pack_rows("Control variables", 3, 4, latex_gap_space = "2em")

kable(hc_one, caption = "Table 2: Effect of congruency of venture attention and institutional level of human capital", format = "latex") %>%
  add_header_above(c(" ", "Model w/ controls" = 4, "Model w/o controls" = 4), italic = T) %>%
  kable_styling(latex_options = c("repeat_header")) %>%
  pack_rows("Control variables", 3, 4, latex_gap_space = "2em")

kbl(fc_zero, caption = "Table 3: Effect of attention to financial capital") %>%
  add_header_above(c(" ", "Model w/ controls" = 4, "Model w/o controls" = 4), italic = T) %>%
  kable_styling(latex_options = c("repeat_header")) %>%
  pack_rows("Control variables", 3, 4, latex_gap_space = "2em")

kbl(fc_one, caption = "Table 4: Effect of congruency of venture attention and institutional level (SME financing) of financial capital") %>%
  add_header_above(c(" ", "Model w/ controls" = 4, "Model w/o controls" = 4), italic = T) %>%
  kable_styling(latex_options = c("repeat_header")) %>%
  pack_rows("Control variables", 3, 4, latex_gap_space = "2em")

kbl(fc_two, caption = "Table 5: Effect of congruency of venture attention and institutional level (VC) of financial capital") %>%
  add_header_above(c(" ", "Model w/ controls" = 4, "Model w/o controls" = 4), italic = T) %>%
  kable_styling(latex_options = c("repeat_header")) %>%
  pack_rows("Control variables", 3, 4, latex_gap_space = "2em")

kbl(fc_three, caption = "Table 6: Effect of congruency of venture attention and institutional level (Credit gaps) of financial capital") %>%
  add_header_above(c(" ", "Model w/ controls" = 4, "Model w/o controls" = 4), italic = T) %>%
  kable_styling(latex_options = c("repeat_header")) %>%
  pack_rows("Control variables", 3, 4, latex_gap_space = "2em")

kbl(sc_zero, caption = "Table 7: Effect of attention to social capital") %>%
  add_header_above(c(" ", "Model w/ controls" = 4, "Model w/o controls" = 4), italic = T) %>%
  kable_styling(latex_options = c("repeat_header")) %>%
  pack_rows("Control variables", 3, 4, latex_gap_space = "2em")

kbl(sc_one, caption = "Table 8: Effect of congruency of venture attention and institutional level of social capital") %>%
  add_header_above(c(" ", "Model w/ controls" = 4, "Model w/o controls" = 4), italic = T) %>%
  kable_styling(latex_options = c("repeat_header")) %>%
  pack_rows("Control variables", 3, 4, latex_gap_space = "2em")

#kable(sc1_c[,-1], escape = FALSE, caption = "Table 16: Effect of congruency of venture attention and institutional level of social capital - Model with controls")

```


```{r eval=FALSE, message=FALSE, warning=FALSE, include=FALSE}
#Outcome: Resource acquistion 
library(lme4)

fit00hc <- lmer(hr_tot ~  accel_ben_rank_business_skills + (accel_ben_rank_business_skills|country), data = gali_joined, REML = F)

fit11hc <- lmer(hr_tot ~  accel_ben_rank_business_skills*EOSQ403 + (accel_ben_rank_business_skills|country), data = gali_joined, REML = F)

fit00fc <- lmer(capital_raised_tot ~ + accel_ben_rank_direct_funding+ (accel_ben_rank_direct_funding|country), data = gali_joined, REML = F)

fit11fc <- lmer(capital_raised_tot ~ accel_ben_rank_direct_funding*EOSQ425 + (accel_ben_rank_direct_funding |country ), data = gali_joined, REML = F)

fit22fc <- lmer(capital_raised_tot ~ accel_ben_rank_direct_funding*EOSQ089 + (accel_ben_rank_direct_funding |country ), data = gali_joined, REML = F)

fit33fc <- lmer(capital_raised_tot ~ accel_ben_rank_direct_funding*DOMCREDITGDP + (accel_ben_rank_direct_funding |country), data = gali_joined, REML = F)

fit00sc <- lmer(equity_sources_tot ~ accel_ben_rank_network + (accel_ben_rank_network |country), data = gali_joined, REML = F)

fit11sc <- lmer(equity_sources_tot ~ accel_ben_rank_network*EOSQ109 + (accel_ben_rank_network | country), data = gali_joined, REML = F)

hc00 <- summary_table(summary(fit00hc))
hc11 <- summary_table(summary(fit11hc))
fc00 <- summary_table(summary(fit00fc))
fc11 <- summary_table(summary(fit11fc))
fc22 <- summary_table(summary(fit22fc))
fc33 <- summary_table(summary(fit33fc))
sc00 <- summary_table(summary(fit00sc))
sc11 <- summary_table(summary(fit11sc))


rownames(hc00) <- c("Intercept","Attention to Human capital")
rownames(hc11) <- c("Intercept","AHC", "Ease of finding skilled employees", "AHCxEase of finding skilled employees")
rownames(fc00) <- c("Intercept","Attention to Financial capital")
rownames(fc11) <- c("Intercept","AFC", "Financing of SMEs", "AFCxFinancing of SMEs")
rownames(fc22) <- c("Intercept","AFC", "VC Availability", "AFCxVC Availability")
rownames(fc33) <- c("Intercept","AFC", "Domestic Credit Gaps", "AFCxDomestic Credit Gaps")
rownames(sc00) <- c("Intercept","Attention to Social capital")
rownames(sc11) <- c("Intercept","ASC", "State of cluster development","ASCxState of cluster development")
    

#kable(hc00[,-1], escape = FALSE)
#kable(hc11[,-1], escape = FALSE)
#kable(fc00[,-1], escape = FALSE)
#kable(fc11[,-1], escape = FALSE)
#kable(fc22[,-1], escape = FALSE)
#kable(fc33[,-1], escape = FALSE)
#kable(sc00[,-1], escape = FALSE)
#kable(sc11[,-1], escape = FALSE, caption = "This is the table caption")

```


# Discussion


\newpage

# References

\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

<div id="refs" custom-style="Bibliography"></div>
\endgroup
